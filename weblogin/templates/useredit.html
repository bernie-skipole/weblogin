<!DOCTYPE html>
<html lang="en">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Set Password</title>
<style>
html, body {
  height: 100%;
  margin: 0;
  }
</style>
<link rel="stylesheet" href="/static/w3.css">
<link rel="stylesheet" href="/static/w3-colors-flat.css">
<script src="/static/htmx.min.js"></script>
<script src="/static/alpinejs.min.js" defer></script>

<body class="w3-flat-clouds">

  <header class="w3-container w3-flat-silver w3-block">
    <p class="w3-margin-right w3-left"><a href="/" class="w3-button w3-black w3-ripple w3-round w3-medium">Site Root</a></p>
    <h1>Site title - edit the template to set this</h1>
  </header>

<div x-data="{ open: false, changemessage:'Change password', close:'Close' }" style="margin-left:auto;width:80%;max-width:400px;margin-right:auto;margin-top:15vh">

    <div>
     <button x-on:click="open=!open" x-text="open ? close : changemessage" class="w3-button w3-black w3-ripple w3-round" style="width:100%"></button>
    </div>

  <div x-show="open" class="w3-container w3-card" style="margin-top:5vh;">
    <p>Change password for user: ${user | h}</p>
    <form hx-post="/edit/changepwd" hx-target="#result" hx-swap="outerHTML" hx-on::after-request="if(event.detail.successful) this.reset()">
     <p><label for="oldpassword">Old Password:</label>
      <input class="w3-input" type="password" id="oldpassword" name="oldpassword" required /></p>
     <p><label for="password1">New Password:</label>
      <input class="w3-input" type="password" id="password1" name="password1" required /></p>
     <p><label for="password2">New Password again:</label>
      <input class="w3-input" type="password" id="password2" name="password2" required /></p>
     <p class="w3-center">
       <button class="w3-button w3-black w3-ripple w3-round" type="submit">Submit</button></p>
    </form>
    <p id="result">Please set a new password</p>
  </div>

</div>

<div x-data="{ open: false }" style="margin-left:auto;width:80%;max-width:400px;margin-right:auto;margin-top:5vh">

    <div>
     <button x-on:click="open=!open" x-text="open ? 'Do not delete user' : 'Delete user'" class="w3-button w3-black w3-ripple w3-round" style="width:100%"></button>
    </div>

  <div x-show="open" class="w3-center" style="margin-top:5vh;">
    <p>This deletes your ${user | h} account, and logs you off permanently. Are you sure you want to do this?</p>
    <p><button hx-post="/edit/deluser" hx-target="#delresult" class="w3-button w3-black w3-ripple w3-round">Yes, Please delete my account</button></p>
    <p id="delresult" class="w3-red" x-text="open ? '' : ''"></p>
  </div>

</div>


</body>
</html>
